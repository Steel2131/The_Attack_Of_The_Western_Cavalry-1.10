#textdomain wesnoth-taotwc

# chosen 1: alliance with Lawrence
# chosen 2: alliance with Haldric
# Lawrence 1:Lawrence has the lance, but Haldric still alive
# Aethyr 1:He has the lance, everybody else alive
# Aethyr 2:He has the lance, Haldric dead, willing to kill Lawrence
# Aethyr 3:He has the lance, Lawrence dead, willing to kill Haldric
# Haldric 1:Haldric has the lance, but Lawrence still alive
# Talar X:Turns before arrival of Mal-Talar

[scenario]
    id=11_The_Lance_Of_The_Devil
    name= _ "The Lance Of The Devil"
    map_data="{~add-ons/The_Attack_Of_The_Western_Cavalry/maps/11_The_Lance_Of_The_Devil.map}"
    # The default next scen is Bitterhold fort, because this stays mostly, 
    # so we can use the simple {VICTORY} macro.
    next_scenario=12a_Bitterhold_Fort
#ifdef EASY
    turns=30
#endif
#ifdef HARD
    turns=25
#endif
    victory_when_enemies_defeated=no
    disallow_recall=no

    {DEFAULT_SCHEDULE_DAWN}
    {~add-ons/The_Attack_Of_The_Western_Cavalry/utils/summarise_no_deaths.cfg}


    [story]
        [part]
            story= _ "They unloaded. Aethyr got a nice hook to his missing hand, and a cute bandage to his pricked eye. After that, they started riding at a gallop."
            background=story/wesnoth2.png
            music=intro_00.ogg
        [/part]
        [part]
            story= _ "They had to cross some silly garrissons, but it was not a problem for them; they were so determined that none could stop them."
            background=story/fight1.jpg
        [/part]
        [part]
            story= _ "But when they arrived at Glamdrom, they had to face the fact that..."
            background=story/wesnoth2.png
        [/part]
        [part]
            story= _ "Someone was quicker than them."
            background=campaign_image.png
            music=vengeful.ogg
        [/part]
        [part]
            story= _ "They got into the middle of the battle."
            background=story/fight2.png
            show_title=yes
        [/part]
        [part]
            story= _ "Everyone was there. The whole cavalry of Lawrence, the whole army of Xanthos II, and the whole army of Haldric VII (the king of Wesnoth)."
            background=story/fight2.png
            show_title=yes
        [/part]
        [part]
            story= _ "Aethyr took his sword. He knew: now he will win, or he will die. He shouted his words, 'Even if I die, the last stroke is mine!'"
            background=story/fight2.png
            show_title=yes
        [/part]
    [/story]

    ###########################
    ##ITEMS, SCENERY, OBJECTS##
    ###########################

    # Well, it's a TODO ;)

    {ARMOR_LEADER 49 5 Armor1}
    {HELMET_RIDER 26 7 Helmet1}
    {HELMET_RIDER 10 12 Helmet2}
#ifdef EASY
    {HELMET_HUMAN 36 23 Helmet2}
#endif
    {ARMOR_BOOTS 33 19 Armor2}



    [event]
        name=prestart
        [objectives]
            side=1
            [objective]
                description= _ "Kill Xanthos II to take the Lance"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Aethyr"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Leogwyn"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Warwick"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Garak"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tal-M'rgan"
                condition=lose
            [/objective]
        [/objectives]


        #############
        ##MAL-TALAR##
        #############
        #{PETRIFIED_UNIT (Necromancer) Statue (_ "Mal-Talar") 44 25}
        #[+unit]
        #    facing=nw
        #    description=_ "Mal-Talar was a really 'terrifying necromancer'. He betrayed Wesnoth, the Alliance, and the Western Kingdom too. He was trying to inform Xanthos II that Commodore Aethyr is going here to stole the Lance of the Devil. But the skeletons whom he wanted to cover his back were not strong enough, so they failed, and a mage's petrification spell has hit Mal-Talar. Since then, only this statue keeps the memory of the Dark Leader, Mal-Talar. R.I.P. (If he can...consider that he has more than 5t concrete on his head...)"
        #[/unit]


        #########
        ##UNITS##
        #########


        ## Ships ##
        {NAMED_SHIP_UNIT 8 (Flagship) 15 19 Overlord (_ "Overlord")}
        {NAMED_SHIP_UNIT 8 (Flagship) 16 19 Ship1 (_ "War Hatchet")}
        {NAMED_SHIP_UNIT 8 (Flagship) 17 20 Ship2 (_ "Conqueror")}
        {NAMED_SHIP_UNIT 8 (Flagship) 18 20 Ship3 (_ "Armageddon")}
        {MODIFY_UNIT type=Flagship facing se}

        {NAMED_SHIP_UNIT 1 (Flagship) 52 51 Xanthosship (_ "Xanthos I (Flagship)")}
        {MODIFY_UNIT id=Xanthosship facing nw}


        ## Wesnothians ##
        {WOUNDED_UNIT 5 (Spearman) 43 38 (Wesnothian1) 12 22}
        {WOUNDED_UNIT 5 (Spearman) 43 39 (Wesnothian2) 22 2}
        {ID_LOYAL_UNIT 5 (Bowman) 37 30 (Wesnothian3)}
        {WOUNDED_UNIT 5 (Bowman) 38 30 (Wesnothian4) 32 1}
        {WOUNDED_UNIT 5 (Bowman) 39 31 (Wesnothian5) 2 6}
        {WOUNDED_UNIT 5 (Lieutenant) 39 30 (Wesnothian6) 40 2}
        {WOUNDED_UNIT 5 (Lieutenant) 38 29 (Wesnothian7) 22 10}
        {WOUNDED_UNIT 5 (Pikeman) 33 35 (Wesnothian8) 37 15}
        {ID_LOYAL_UNIT 5 (Heavy Infantryman2) 41 34 (Wesnothian9)}
        {ID_LOYAL_UNIT 5 (Heavy Infantryman2) 41 35 (Wesnothian10)}

        ## Westerns ##
        {ID_LOYAL_UNIT 2 (Western Knight) 33 31 (Western1)}
        {ADD_NEW_TRAIT id=Western1 (TRAIT_WOUNDED)}
        {WOUNDED_UNIT 2 (Western Horseman) 34 31 (Western2) 35 1}
        {ID_LOYAL_UNIT 2 (Western Cavalier) 37 40 (Western3)}
        {ID_LOYAL_UNIT 2 (Western Cavalryman) 38 40 (Western4)}
        {ID_LOYAL_UNIT 2 (Western Cavalryman) 39 41 (Western5)}
        {WOUNDED_UNIT 3 (Western Commander) 33 34 (Western6) 45 3}
        {WOUNDED_UNIT 3 (Western Junior Commander) 32 34 (Western7) 12 1}
        {WOUNDED_UNIT 3 (Western Cavalryman) 34 34 (Western8) 42 2}
        {WOUNDED_UNIT 3 (Western Dragoon) 34 35 (Western9) 23 36}
        {ID_LOYAL_UNIT 3 (Western Dragoon) 32 35 (Western10)}

        ## Xanthos's city guards ##
        {GUARDIAN_ID_UNIT 7 (Swamp Warrior) 27 28 (Swamp1)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 29 28 (Swamp2)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 31 27 (Swamp3)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 33 26 (Swamp4)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 35 25 (Swamp5)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 38 23 (Swamp6)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 35 22 (Swamp8)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 34 20 (Swamp9)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 35 18 (Swamp10)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 37 17 (Swamp11)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 38 15 (Swamp12)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 38 13 (Swamp13)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 36 12 (Swamp14)}
        {GUARDIAN_ID_UNIT 7 (Swamp Fighter) 34 11 (Swamp15)}

        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 20 22 (Swamp17)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 25 13 (Swamp18)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 22 12 (Swamp19)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 18 12 (Swamp20)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 16 12 (Swamp21)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 14 13 (Swamp22)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 10 12 (Swamp23)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 10 10 (Swamp24)}
        {GUARDIAN_ID_UNIT 8 (Swamp Walker) 10 7 (Swamp25)}
        {GUARDIAN_ID_UNIT 8 (Western Commander) 29 18 (Swamp26)}
        {GUARDIAN_ID_UNIT 8 (Swamp Walker) 33 19 (Swamp27)}
        {GUARDIAN_ID_UNIT 8 (Swamp Fighter) 27 15 (Swamp28)}


#ifdef EASY
        {GUARDIAN_ID_UNIT 7 (Swamp Warrior) 36 23 (Swamp7)}
        {GUARDIAN_ID_UNIT 8 (Swamp Warrior) 21 22 (Swamp16)}
#endif
#ifdef HARD
        {GUARDIAN_ID_UNIT 7 (Swamp General) 36 23 (Swamp7)}
        {GUARDIAN_ID_UNIT 8 (Swamp Walker) 21 22 (Swamp16)}
#endif



        #############
        ##VARIABLES##
        #############
        # Predefined variables
        {VARIABLE lance_of_the_devil_dropped 0}
        {VARIABLE chosen 0}
        {VARIABLE Aethyr 0}
        {VARIABLE Lawrence 0}
        {VARIABLE Haldric 0}
        {VARIABLE added_gold 0}
        {VARIABLE Talar 0}
        {VARIABLE talar_count on}
        {VARIABLE lance_new.x 0}
        {VARIABLE lance_new.y 0}
        {VARIABLE lance_place.x 0}
        {VARIABLE lance_place.y 0}




        ###############
        ##UNIT SET UP##
        ###############

        {MODIFY_UNIT id=Boldragur overlays misc/loyal-icon.png}
        {ADD_NEW_TRAIT id=Aethyr (TRAIT_WOUNDED)}

        [object]
            silent=yes
            [filter]
                id=Xanthos
            [/filter]
            [effect]
                apply_to=new_attack
                name=lance
                description= _ "lance of the devil"
                icon=attacks/lance.png
                type=pierce
                range=melee
                [specials]
                    {WEAPON_SPECIAL_CHARGE}
                    {WEAPON_SPECIAL_MAGICAL}
                    {WEAPON_SPECIAL_FIRSTSTRIKE}
                [/specials]
                damage=30
                number=5
            [/effect]
            [effect]
                apply_to=hitpoints
                increase_total=10
            [/effect]
        [/object]

        {FULL_HEAL id=Xanthos}


        ##A little setting things right after previous scenario...##
        [disallow_recruit]
            type=Western Fregatt,Improved Fregatt,Western Battleship,Western Boat
        [/disallow_recruit]

        [recall]
            id=Boldragur
            x,y=49,52
        [/recall]
        [recall]
            id=Warwick
            x,y=50,51
        [/recall]

        {MODIFY_UNIT id=Warwick profile (portraits/warwick2.png)}
        {ADD_NEW_TRAIT id=Warwick (TRAIT_WOUNDED)}  

        [recall]
            id=Leogwyn
            x,y=51,51
        [/recall]
        [recall]
            id=Morgan
            x,y=49,50
        [/recall]
        [recall]
            id=Garak
            x,y=49,50
        [/recall]
        
        [if]
            [variable]
                name=unit_recruitment.recruit
                contains=Thug
            [/variable]
            [then]
                [allow_recruit]
                    type=Western Horseman,Western Cavalryman,Western Junior Commander,Prisoner2,Skeleton2,Skeleton Archer2,Walking Corpse2,Ghoul2,Ghost2,Skeleton Rider2,Thief,Thug,Poacher
                [/allow_recruit]
            [/then]
            [else]
                [allow_recruit]
                    type=Western Horseman,Western Cavalryman,Western Junior Commander,Prisoner2,Skeleton2,Skeleton Archer2,Walking Corpse2,Ghoul2,Ghost2,Skeleton Rider2,Elvish Fighter2,Elvish Archer
                [/allow_recruit]
            [/else]
        [/if]

        {CLEAR_VARIABLE unit_recruitment}
    [/event]


    ##################
    ##DEATHS, WRECKS##
    ##################

    # If the Overlord sinks, side 8 will lost it's gold
    [event]
        name=last breath
        [filter]
            id=Overlord
        [/filter]

        [store_unit]
            [filter]
                id=Overlord
            [/filter]

            kill=no
            variable=wreck
        [/store_unit]
        [message]
            speaker=narrator
            caption= _ "Captain of the '$wreck.name|'"
            image=portraits/captain.png
            message= _ "My Emperor! The pride of the armada is sinking...with all of your gold..."
        [/message]
        [item]
            x,y=$wreck.x,$wreck.y
            image=scenery/shipwreck-1.png
        [/item]
        {DELETE_SIDE_GOLD 8}

        {CLEAR_VARIABLE wreck,defeat_yes_or_no}  
    [/event]





    {HUMAN_WRECK_EFFECT Xanthosship (Commodore, the Xanthos I is sinking! We shall meet in the Underness!) (no)}

    {HUMAN_WRECK_EFFECT Ship1 (Lord Emperor! We're sinking...) (no)}
    {HUMAN_WRECK_EFFECT Ship2 (Sir! We gotta give up, we can't hold it...we'll meet again!) (no)}
    {HUMAN_WRECK_EFFECT Ship3 (My crew is dying Emperor...we'll meet in the Underness!) (no)}


    {HUMAN_WRECK_EFFECT Flagship (Take the boats! We're sinki...blgy..blgy...) (no)}
    {HUMAN_WRECK_EFFECT Flagship2 (We're sinking sir!) (no)}
    {HUMAN_WRECK_EFFECT Flagship3 (I know the undead don't need oxygen, but we, mortals, do! You should help us to stop this leak up, or we'll sink!) (no)}
    {HUMAN_WRECK_EFFECT Battleship1 (Commodore, we can't plug this leak! We'll meet in the Underness.) (no)}
    {HUMAN_WRECK_EFFECT Battleship2 (Commodore! All of my crew is dead, I'm the last one, and the ship is sinking. I shall die as a Western Captain, I'll sink together with my ship!) (no)}
    {HUMAN_WRECK_EFFECT Battleship3 (It's the end! We meet in the Underness!) (no)}
    {HUMAN_WRECK_EFFECT Battleship4 (I wonder how much more can we hold it on...but we gotta consider that the keel and all the robs are broken, there's a hole in the middle of the deck, the water level's rising, the sail's burned, and all the masts have fallen...) (no)}

    {CORPSES (
        {NOT id=Aethyr}
        {NOT id=Leogwyn}
        {NOT id=Morgan}
        {NOT id=Garak}
        {NOT id=Warwick}
        {NOT id=Boldragur}
        {NOT id=Lawrence}
        {NOT id=Addroqryr}
        {NOT id=Gweodryn}
        {NOT id=Haldric}
        {NOT id=Gweoc}
        {NOT id=Alkhralok}
        {NOT id=Xanthos}
        {NOT id=Talar}
        {NOT id=Talar2}
    )}




    #########
    ##SIDES##
    #########
    [side]
#ifdef EASY
        gold=350
#endif
#ifdef HARD
        gold=300
#endif
        type=Western Knight
        id=Aethyr
        name= _ "Aethyr"
        unrenamable=yes
        profile="portraits/aethyr.png"
        side=1
        canrecruit=yes
        controller=human
        {FLAG_CAVALRY}
        recruit=Western Horseman,Western Cavalryman,Western Junior Commander,Prisoner2,Skeleton2,Skeleton Archer2,Walking Corpse2,Ghoul2,Ghost2,Skeleton Rider2
        team_name=Westerns
        user_team_name=_"Western Cavalry"
        fog=yes
    [/side]
    [side]
        type=Rider Of Apocalypse
        id=Lawrence
        name= _ "XIII.Lawrence, the Rider of Apocalypse"
        profile=portraits/rider-of-apocalypse.png
        side=2
        controller=ai
        canrecruit=yes
        recruit=Western Knight,Western Commander,Western Dragoon,Bone Knight2,Chocobone2
        team_name=Lawrence
        user_team_name=_"Western Knigdom"
        fog=yes
        [ai]
            time_of_day=dusk
            aggression=0.9
            caution=0.25
        [/ai]
        [ai]
            time_of_day=first_watch,second_watch
            aggression=1.0
            caution=0.0
        [/ai]
        [ai]
            [target]
                id=Xanthos
                value=10
            [/target]
            [target]
                side=5
                value=150
            [/target]
            [target]
                side=6
                value=100
            [/target]
        [/ai]
        [ai]
            [avoid]
                x,y=1-54,1-23
            [/avoid]
            passive_leader=yes
        [/ai]
        gold=350
    [/side]
    [side]
        gold=300
        type=Western Commander
        id=Gweodryn
        name= _ "Gweodryn"
        unrenamable=yes
        side=3
        canrecruit=yes
        controller=ai
        recruit=Western Horseman,Western Cavalryman,Western Junior Commander
        team_name=Lawrence
        user_team_name=_"Western Knigdom"
        fog=yes
        [ai]
            aggression=1.0
        [/ai]
        [ai]
            [avoid]
                x,y=1-54,1-23
            [/avoid]
            passive_leader=yes
        [/ai]
    [/side]
    [side]
        gold=300
        type=Western Commander
        id=Addroqryr
        name= _ "Addroqryr"
        unrenamable=yes
        side=4
        canrecruit=yes
        controller=ai
        recruit=Western Horseman,Western Cavalryman,Western Junior Commander
        team_name=Lawrence
        user_team_name=_"Western Knigdom"
        fog=yes
        [ai]
            aggression=1.0
        [/ai]
        [ai]
            [avoid]
                x,y=1-54,1-23
            [/avoid]
            passive_leader=yes
        [/ai]
    [/side]

    #Wesnoth
    [side]
        gold=400
        type=King
        id=Haldric
        name= _ "Haldric VII"
        profile=portraits/haldric.png
        unrenamable=yes
        side=5
        canrecruit=yes
        controller=ai
        recruit=Longbowman,Pikeman,Halberdier,Master Bowman
        team_name=Wesnoth
        user_team_name=_"Kingdom of Wesnoth"
        fog=yes
        [ai]
            aggression=1.0
        [/ai]
        [ai]
            [target]
                id=Xanthos
                value=10
            [/target]
            [target]
                side=2
                value=150
            [/target]
            [target]
                side=3
                value=100
            [/target]
            [target]
                side=4
                value=100
            [/target]
        [/ai]
        [ai]
            [avoid]
                x,y=1-54,1-23
            [/avoid]
            passive_leader=yes
        [/ai]
    [/side]
    [side]
        gold=350
        type=Grand Marshal
        id=Gweoc
        name= _ "Gweoc"
        profile=portraits/gweoc.png
        unrenamable=yes
        side=6
        canrecruit=yes
        controller=ai
        recruit=Spearman,Bowman,Longbowman,Pikeman
        team_name=Wesnoth
        user_team_name=_"Kingdom of Wesnoth"
        fog=yes
        [ai]
            aggression=1.0
        [/ai]
        [ai]
            [avoid]
                x,y=1-54,23
            [/avoid]
            passive_leader=yes
        [/ai]
    [/side]
    [side]
        id=Alkhralok
        name= _ "Alkhralok"
        type=Swamp Walker
        profile=portraits/gweoc.png
        unrenamable=yes
        gold=150
        side=7
        canrecruit=yes
        controller=ai
        recruit=Swamp Fighter,Swamp Warrior
        team_name=Xanthos
        user_team_name=_"Western Empire"
        fog=yes
        [ai]
            aggression=1.0
        [/ai]
        [ai]
            [target]
                id=Haldric
                value=100
            [/target]
            [target]
                side=2
                value=50
            [/target]
        [/ai]
    [/side]
    [side]
        id=Xanthos
        name= _ "Xanthos II"
        type=General Of Death
        profile=portraits/xanthos_king.png
        unrenamable=yes
        gold=250
        side=8
        canrecruit=yes
        controller=ai
        recruit=Swamp General,Swamp Walker,Western Knight,Western Lancer,Western Commander
        team_name=Xanthos
        user_team_name=_"Western Empire"
        fog=yes
        [ai]
            aggression=1.0
        [/ai]
        [ai]
            [target]
                id=Haldric
                value=100
            [/target]
            [target]
                side=2
                value=50
            [/target]
        [/ai]
        [ai]
            passive_leader=yes
        [/ai]
    [/side]
    [side]
        side=9
        no_leader=yes
        controller=ai
        team_name=Xanthos
        user_team_name=_"The Alliance"
        fog=yes
        [ai]
            {TARGET_TO target_location (x,y=18-20,16-18) (value=100)}
        [/ai]
    [/side]





    #########
    ##START##
    #########
    [event]
        name=start
        [message]
            speaker=Warwick
            message= _ "Yes Commodore, I agree, but look at the sizes! We can be only defeated in this battle! On top of all, we're both wounded, and can't fight properly!"
        [/message]
        [message]
            speaker=Aethyr
            message= _ "*<i>angry</i>* Do you know anything better?"
        [/message]
        [message]
            speaker=Leogwyn
            message= _ "Commodore, if I may..."
        [/message]
        [message]
            speaker=Aethyr
            message= _ "What do you have?"
        [/message]
        [message]
            speaker=Leogwyn
            message= _ "Commodore, we don't have to cross swords with all of them. We could side with Haldric VII, or..."
        [/message]
        [message]
            speaker=Aethyr
            message= _ "I don't side with the king of Wesnoth, but your idea has something in it..."
        [/message]
        [message]
            speaker=Aethyr
            message= _ "Perhaps we can cross this battlefield just as we did at the way to the Swamp of Dread."
        [/message]
        [message]
            speaker=Warwick
            message= _ "Maybe...but we need to side with somebody anyway. We can't take control over the city just by ourselves."
        [/message]
        [message]
            speaker=Aethyr
            message= _ "And what about this? We begin fighting with everybody. By this, we can measure who's the strongest one, and we side with it."
        [/message]
        [message]
            speaker=Leogwyn
            message= _ "It sounds possible! Do it!"
        [/message]
        [terrain]
            terrain=Ke
            x,y=50,50
        [/terrain]
        [terrain]
            terrain=Ce
            x,y=49,50
        [/terrain]
        [terrain]
            terrain=Ce
            x,y=49,51
        [/terrain]
        [terrain]
            terrain=Ce
            x,y=51,51
        [/terrain]
        [terrain]
            terrain=Chw
            x,y=51,50
        [/terrain]
        [terrain]
            terrain=Chw
            x,y=50,49
        [/terrain]
        [terrain]
            terrain=Ce
            x,y=49,50
        [/terrain]
    [/event]


    ############
    ##SIGHTEDS##
    ############


    [event]
        name=sighted
        [filter]
            side=2,3,4,5,6,7,8
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [message]
            speaker=second_unit
            message= _ "I can see the battle!"
        [/message]
        [message]
            speaker=unit
            message= _ "More enemies? Just come, come to your death! Welcome!"
        [/message]
    [/event]

    [event]
        name=sighted
        first_time_only=yes
        [filter]
            id=Lawrence
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [modify_side]
            side=2
            team_name=Westerns
            share_view=yes
        [/modify_side]
        [modify_side]
            side=3
            team_name=Westerns
            share_view=yes
        [/modify_side]
        [modify_side]
            side=4
            team_name=Westerns
            share_view=yes
        [/modify_side]
        [modify_side]
            side=5
            team_name=Westerns
            share_view=yes
        [/modify_side]
        [modify_side]
            side=6
            team_name=Westerns
            share_view=yes
        [/modify_side]

        {REDRAW_SIDES 6}

        [message]
            speaker=Lawrence
            message= _ "Wow, what can we see there! The lieutenant! I had to think that they've killed ya!"
		[/message]
        [message]
            speaker=Aethyr
            message= _ "I ain't a lieutenant anymore, I unified two hordes, so I'm a Commodore just as you!"
		[/message]
        [message]
            speaker=Lawrence
            message= _ "OK...we'll talk about this later! But we gotta kill Xanthos II and just another task, the wesnothian king, Haldric II and his corpses-to-be are here too!"
		[/message]
        [message]
            speaker=Haldric
            message= _ "You have just described yourself and your dirty lot that you call an 'army'."
		[/message]
        [message]
            speaker=Aethyr
            message= _ "Haldric, do you anything about the Lance?"
		[/message]
        [message]
            speaker=Haldric
            message= _ "I have spies everywhere young Commodore, I know everything. If you want to, you can attach my army. Join, and we can clear these westerns off the map. You can be a count with time."
		[/message]
        [message]
            speaker=Aethyr
            message= _ "Hmm..."
            [option]
                message= _ "Agreed!"
                [command]
                    [modify_side]
                    	side=2
            			team_name=Lawrence
        			[/modify_side]
        			[modify_side]
            			side=3
            			team_name=Lawrence
        			[/modify_side]
     			    [modify_side]
  				        side=4
           				team_name=Lawrence
        			[/modify_side]

                    {REDRAW_SIDES 6}

        			[terrain]
           			    terrain=Gg
            			x,y=50,50
        			[/terrain]
        			[terrain]
            			terrain=Gg
            			x,y=49,50
        			[/terrain]
        			[terrain]
            			terrain=Gg
           				x,y=49,51
        			[/terrain]
        			[terrain]
           				terrain=Gg
            			x,y=51,51
        			[/terrain]
        			[terrain]
            			terrain=Ww
            			x,y=51,50
        			[/terrain]
        			[terrain]
            			terrain=Ww
            			x,y=50,49
        			[/terrain]
        			[terrain]
            			terrain=Gg
            			x,y=49,50
        			[/terrain]

                    [terrain]
            			terrain=Ke
            			x,y=52,35
        			[/terrain]
                    [terrain]
            			terrain=Ce
            			x,y=52,36
        			[/terrain]
                    [terrain]
            			terrain=Ce
            			x,y=53,36
        			[/terrain]
                    [terrain]
            			terrain=Ce
            			x,y=53,35
        			[/terrain]
                    [terrain]
            			terrain=Ce
            			x,y=52,34
        			[/terrain]
                    [terrain]
            			terrain=Ce
            			x,y=51,35
        			[/terrain]

                    [teleport]
                        [filter]
                            id=Aethyr
                        [/filter]
                        x,y=52,35
                    [/teleport]
                    {REDRAW}

                    [message]
                        speaker=Gweoc
                        message= _ "So...we meet again."
                    [/message]
                    [message]
                        speaker=Aethyr
                        message= _ "Oh hello...yes...er..khm..and...how are ya?"
                    [/message]
                    [message]
                        speaker=Gweoc
                        message= _ "Fine."
                    [/message]
                    [message]
                        speaker=Haldric
                        message= _ "Okay, so, here is my plan! Me and Gweoc are trying to waylay Lawrence till you, Aethyr, and your men conquer the city."
                    [/message]
                    [message]
                        speaker=Gweoc
                        message= _ "It will be good. Attack!"
                    [/message]

                    [allow_recruit]
                        type=Spearman,Bowman,Fencer
                    [/allow_recruit]
                    {VARIABLE chosen 2}
#ifdef EASY
                    [gold]
                        side=2
                        amount=350
                    [/gold]
                    [gold]
                        side=3
                        amount=200
                    [/gold]
                    [gold]
                        side=4
                        amount=200
                    [/gold]
#endif
#ifdef HARD
                    [gold]
                        side=2
                        amount=400
                    [/gold]
                    [gold]
                        side=3
                        amount=250
                    [/gold]
                    [gold]
                        side=4
                        amount=250
                    [/gold]
#endif
                    [modify_side]
                        side=5
                        team_name=Westerns
                        share_view=no
                    [/modify_side]
                    [modify_side]
                        side=6
                        team_name=Westerns
                        share_view=no
                    [/modify_side]
                [/command]
            [/option]
            [option]
                message= _ "No fool would side with the weak Wesnoth!"
                [command]
                    [modify_side]
                    	side=5
            			team_name=Haldric
        			[/modify_side]
        			[modify_side]
            			side=6
            			team_name=Haldric
        			[/modify_side]

                    {REDRAW_SIDES 6}


                    [message]
                        speaker=Lawrence
                        message= _ "Good. Now, Here's my plan. Me, Addroqryr, and Gweodryn attack the wesnothians while you're getting the Lance to me, right?"
                    [/message]
                    [message]
                        speaker=Aethyr
                        message= _ "Okay, but I gotta be near to you."
                    [/message]
                    [message]
                        speaker=Lawrence
                        message= _ "No problem, then Addroqryr moves camp. Go back to Aldril, and guard the city! Yer my hand!"
                    [/message]
                    [message]
                        speaker=Addroqryr
                        message= _ "As you wish My King!"
                    [/message]
                    [kill]
                        id=Addroqryr
                    [/kill]
                    {STORE_UNIT_VAR (id=Aethyr) side aethyr_side}
                    {MODIFY_UNIT (side=4) side $aethyr_side}
                    {CLEAR_VARIABLE aethyr_side}

                    [teleport]
                        [filter]
                            id=Aethyr
                        [/filter]
                        x,y=30,42
                    [/teleport]
                    
                    [store_gold]
            			side=4
            			variable=side_4_storedgold
        			[/store_gold]
        			[gold]
            			side=1
            			amount=$side_4_storedgold
        			[/gold]
       				[gold]
            			side=4
            			amount=-$side_4_storedgold
        			[/gold]
       				[clear_variable]
            			name=side_4_storedgold
        			[/clear_variable]
                    {VARIABLE chosen 1}
#ifdef EASY
                    [gold]
                        side=5
                        amount=100
                    [/gold]
                    [gold]
                        side=6
                        amount=80
                    [/gold]
#endif
#ifdef HARD
                    [gold]
                        side=5
                        amount=150
                    [/gold]
                    [gold]
                        side=6
                        amount=150
                    [/gold]
#endif
                    [modify_side]
                        side=2
                        team_name=Westerns
                        share_view=no
                    [/modify_side]
                    [modify_side]
                        side=3
                        team_name=Westerns
                        share_view=no
                    [/modify_side]
                    #[modify_side]
                    #    side=4
                    #    team_name=Westerns
                    #    share_view=no
                    #[/modify_side]
                [/command]
            [/option]
	    [/message]
    [/event]


    [event]
        name=sighted
        first_time_only=yes
        [filter]
            type=Swamp Walker
            [or]
                type=Swamp Warrior
            [/or]
            [or]
                type=Swamp Fighter
            [/or]
            [or]
                type=Swamp General
            [/or]
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [message]
            speaker=Leogwyn
            message= _ "For god's sake! What are those?!"
        [/message]
        [message]
            speaker=Aethyr
            message= _ "Swamp Walkers! I haven't seen one since the rebellion."
        [/message]
        [message]
            speaker=Leogwyn
            message= _ "But...<i>what</i> are those?"
        [/message]
        [message]
            speaker=Aethyr
            message= _ "They're dead men. How is it said in your common language? They're <i>rakhosqrom</i>, I don't know how is it in your language..."
        [/message]
        [message]
            speaker=Leogwyn
            message= _ "Are they Undead?"
        [/message]
        [message]
            speaker=Aethyr
            message= _ "Not exactly...I know the way they're made, but I won't tell anybody. It's very dark, very evil. I think their presence means that Xanthos meant this campaign very seriously. The main point is that you gotta be pre-cautious with them, they're dangerous, but they has to be always nearby their leader. They can't think by themselves."
        [/message]
    [/event]



    ##########
    ##BATTLE##
    ##########

    [event]
        name=new turn
		first_time_only=no
        [if]
            [variable]
                name=added_gold
                less_than=4
            [/variable]
            [then]

                {VARIABLE_OP added_gold add 1}
				# Though units are added, the variable is still $added_gold so to avoid calamity.

            [/then]
        [/if]
        [if]
            [variable]
                name=added_gold
                # Don't make mistakes, if some ways it gets greater than X, the event WILL fire
                greater_than_equal_to=4
            [/variable]
            [then]
                {VARIABLE added_gold 0}

                #####################
                # REINFORCE WESNOTH #
                {LOYAL_UNIT 5 Paladin 54 25}
                {LOYAL_UNIT 5 Halberdier 54 24}
                {LOYAL_UNIT 5 Halberdier 54 26}
                [store_locations]
                    x,y=54,25
                    radius=3
                    variable=reinforcement_wesnoth
                [/store_locations]
                {FOREACH reinforcement_wesnoth i}
                    {RANDOM (Pikeman,Master Bowman,Javelineer)}
                    {LOYAL_UNIT 5 $random $reinforcement_wesnoth[$i].x $reinforcement_wesnoth[$i].y}
                {NEXT i}

                #######################
                # REINFORCE WESTERN C.#


#define EXTRACT_RANDOM_UNITS SIDE TYPES X Y
[store_locations]
    x,y={X},{Y}
    radius=1
    variable=extracting
[/store_locations]
{FOREACH extracting i}
    [if]
        [variable]
            name=extracting[$i].x
            numerical_equals={X}
        [/variable]
        [and]
        [variable]
            name=extracting[$i].y
            numerical_equals={Y}
        [/variable]
        [/and]
        [else]

            {RANDOM ({TYPES})}
            {LOYAL_UNIT {SIDE} $random $extracting[$i].x $extracting[$i].y}

        [/else]
    [/if]
{NEXT i}
{CLEAR_VARIABLE extractiong}
#enddef

                        {LOYAL_UNIT 2 (Western Boat) 1 52}
                        {LOYAL_UNIT 2 (Western Boat) 1 53}
                        {LOYAL_UNIT 2 (Western Boat) 2 53}
                        {LOYAL_UNIT 2 (Western Boat) 2 52}	
	
                        {MOVE_UNIT x,y=1,52 14 46}
                        {EXTRACT_RANDOM_UNITS 2 (Western Horseman,Western Junior Commander,Western Cavalryman) 14 46}

                        {MOVE_UNIT x,y=1,53 20 48}
                        {EXTRACT_RANDOM_UNITS 2 (Western Commander,General Of Death,Western Horseman) 20 48}

                        {MOVE_UNIT x,y=2,53 18 42}
                        {EXTRACT_RANDOM_UNITS 2 (Marine,Spearman,Bowman,Fencer) 18 42}

                        {MOVE_UNIT x,y=2,52 16 49}
                        {EXTRACT_RANDOM_UNITS 2 (Dark Adept,Mage,Western Horseman,Western Cavalryman) 16 49}
                        

#undef EXTRACT_RANDOM_UNITS

            [/then]
        [/if]



        #################
        ## MAL - TALAR ##
        #################
        [switch]
            variable=talar_count
            [case]
                value=on
                [switch]
                    variable=chosen
                    [case]
                        value=1
                        {VARIABLE_OP Talar add 1}
                    [/case]
                    [case]
                        value=2
                        {VARIABLE_OP Talar sub 1}
                    [/case]
                [/switch] 
            [/case]
        [/switch]

        [if]
#ifdef EASY
            [variable]
                name=Talar
                greater_than_equal_to=4
            [/variable]    
#endif
#ifdef HARD
            [variable]
                name=Talar
                greater_than_equal_to=3
            [/variable]    
#endif
            [then]
                {VARIABLE talar_count off}
                {VARIABLE Talar 0}
                [modify_side]
                    side=1
                    fog=no
                [/modify_side]
                {REDRAW_SIDE 1}

                {THUNDER (
                    [terrain]
                        [and]
                            terrain=Wo
                        [/and]
                        terrain=Wwf
                    [/terrain]
                    {REDRAW_SIDE 1}


                    [unit]
                        id=Talar
                        name=_"Mal-Talar"
                        profile=portraits/mal-talar.png
                        type=Necromancer
                        [modifications]
                            {TRAIT_EVIL}
                            {TRAIT_STRONG}
                        [/modifications]
                        overlays=misc/second-leader.png
                        side=9
                        x,y=4,49
                        goto_x=19
                        goto_y=17
                    [/unit]
                )}

                    {ID_LOYAL_UNIT 9 (Death Marshal) 4 50 Skeleton1}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=4,50
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton1
                            [/filter]
                        [/animate]
                    [/animate_unit]

                    {ID_LOYAL_UNIT 9 (Death Marshal) 4 48 Skeleton2}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=4,58
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton2
                            [/filter]
                        [/animate]
                    [/animate_unit]

                    {ID_LOYAL_UNIT 9 Banebow 3 49 Skeleton3}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=3,49
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton3
                            [/filter]
                        [/animate]
                    [/animate_unit]

                    {ID_LOYAL_UNIT 9 Banebow 5 49 Skeleton4}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=5,49
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton4
                            [/filter]
                        [/animate]
                    [/animate_unit]
                    {LOYAL_UNIT 9 Spectre 5 50}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=5,50
                        [/facing]
                    [/animate_unit]
                    {LOYAL_UNIT 9 Spectre 3 50}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=3,50
                        [/facing]
                    [/animate_unit]


                {DELAY 700}
                [message]
                    speaker=Talar
                    message= _ "We're not late! Come on, hurry for the citadel!"
                [/message]
                [message]
                    speaker=Leogwyn
                    message= _ "Hail, fellow-necromancer! I see you can shallowen water. Did not expect it from you..."
                [/message]
                [message]
                    speaker=Talar
                    message= _ "Hail skeleton. Shortly you shall see what I'm fully capable of!"
                [/message]

                {THUNDER (
                    [modify_side]
                        side=1
                        fog=yes
                    [/modify_side]
                    {REDRAW_SIDE 1}
                )}
                [message]
                    speaker=Warwick
                    message= _ "We must get him before he reaches Xanthos!"
                [/message]
            [/then]
        [/if]
        [if]
#ifdef EASY
            [variable]
                name=Talar
                less_than_equal_to=-4
            [/variable]    
#endif
#ifdef HARD
            [variable]
                name=Talar
                less_than_equal_to=-3
            [/variable]    
#endif
            [then]
                {VARIABLE talar_count off}
                {VARIABLE Talar 0}

                [modify_side]
                    side=1
                    fog=no
                [/modify_side]
                {REDRAW_SIDE 1}

                {THUNDER (

                    [unit]
                        id=Talar
                        name=_"Mal-Talar"
                        profile=portraits/mal-talar.png
                        type=Necromancer
                        [modifications]
                            {TRAIT_EVIL}
                            {TRAIT_STRONG}
                        [/modifications]
                        overlays=misc/second-leader.png
                        side=9
                        x,y=53,2
                        goto_x=19
                        goto_y=17
                    [/unit]
                )}  


                    {ID_LOYAL_UNIT 9 (Death Marshal) 53 1 Skeleton1}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=53,1
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton1
                            [/filter]
                        [/animate]
                    [/animate_unit]

                    {ID_LOYAL_UNIT 9 (Death Marshal) 53 3 Skeleton2}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=53,3
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton2
                            [/filter]
                        [/animate]
                    [/animate_unit]

                    {ID_LOYAL_UNIT 9 (Banebow) 52 1 Skeleton3}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=52,1
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton3
                            [/filter]
                        [/animate]
                    [/animate_unit]

                    {ID_LOYAL_UNIT 9 (Banebow) 54 1 Skeleton4}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=54,1
                        [/facing]
                        [animate]
                            flag=recruited
                            [filter]
                                id=Skeleton4
                            [/filter]
                        [/animate]
                    [/animate_unit]
                    {LOYAL_UNIT 9 (Spectre) 52 2}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=52,2
                        [/facing]
                    [/animate_unit]
                    {LOYAL_UNIT 9 (Spectre) 54 2}
                    [animate_unit]
                        flag=recruiting
                        [filter]
                            id=Talar
                        [/filter]

                        [facing]
                            x,y=54,2
                        [/facing]
                    [/animate_unit]


                {DELAY 700}
                [message]
                    speaker=Talar
                    message= _ "We're not late! Come on, hurry for the citadel!"
                [/message]
                [message]
                    speaker=Leogwyn
                    message= _ "Hail, fellow-necromancer! So you survived...I though you were killed, I could not sense you..."
                [/message]
                [message]
                    speaker=Talar
                    message= _ "Hail skeleton! Just to let you know, I hid meself. Shortly you shall see what I'm fully capable of!"
                [/message]
                {THUNDER (
                    [modify_side]
                        side=1
                        fog=yes
                    [/modify_side]
                    {REDRAW_SIDE 1}
                )}
                [message]
                    speaker=Warwick
                    message= _ "We must get him before he reaches Xanthos!"
                [/message]
            [/then]
        [/if]
    [/event]


    [event]
        name=moveto
        [filter]
            id=Talar
            [filter_location]
                terrain=Rp^Vhc
            [/filter_location]
        [/filter]

        [modify_side]
            side=1
            fog=no
        [/modify_side]
        {REDRAW_SIDE 1}
        {SCROLL_TO 19 17}
        [message]
            speaker=Talar
            message= _ "*<i>in western</i>*Hail! Pleased to meat thee, Great Lord Emperor!"
        [/message]
        [message]
            speaker=Xanthos
            message= _ "*<i>continues in western</i>*Who are thou, necromancer?"
        [/message]
        [message]
            speaker=Talar
            message= _ "I am the last of the Alliance, the last of the enemies of Wesnoth. My name is Mal-Talar, last and only student of Mal-Zalacras the Great Lich Archon."
        [/message]
        [message]
            speaker=Xanthos
            message= _ "Then thou are welcomed to be under my command. Is the master of thine alive?"
        [/message]
        [message]
            speaker=Talar
            message= _ "Nay, the Great Lich's strength began to reduce showing him it was time to give up his false life, thus he allowed his spirit to leave body, and find false peace. But this must be done later O Great Emperor, I have terrifying news for thee!"
        [/message]
        [message]
            speaker=Xanthos
            message= _ "Pray tell!"
        [/message]
        [message]
            speaker=Talar
            message= _ "Thy traitors, Commodore Aethyr, thou must know him, and his bunch is about to take thy Lance!..."
        [/message]
        {DEFEAT}
    [/event]
    [event]
        name=moveto
        [filter]
            id=Talar2
            [filter_location]
                terrain=Rp^Vhc
            [/filter_location]
        [/filter]

        [modify_side]
            side=1
            fog=no
        [/modify_side]
        {REDRAW_SIDE 1}
        {SCROLL_TO 19 17}
        [message]
            speaker=Talar2
            message= _ "*<i>in western</i>*Hail! Pleased to meat thee, Great Lord Emperor!"
        [/message]
        [message]
            speaker=Xanthos
            message= _ "*<i>continues in western</i>*Who are thou, necromancer?"
        [/message]
        [message]
            speaker=Talar2
            message= _ "I am the last of the Alliance, the last of the enemies of Wesnoth. My name is Mal-Talar, last and only student of Mal-Zalacras the Great Lich Archon."
        [/message]
        [message]
            speaker=Xanthos
            message= _ "Then thou are welcomed to be under my command. Is the master of thy alive?"
        [/message]
        [message]
            speaker=Talar2
            message= _ "Nay, the Great Lich's strength began to reduce showing him it was time to give up his false life, thus he allowed his spirit to leave body, and find false peace. But this must be done later O Great Emperor, I have terrifying news for thee!"
        [/message]
        [message]
            speaker=Xanthos
            message= _ "Pray tell!"
        [/message]
        [message]
            speaker=Talar2
            message= _ "Thy traitors, Commodore Aethyr, thou must know him, and his bunch is about to take thy Lance!..."
        [/message]
        {DEFEAT}
    [/event]

    [event]
        name=last breath
        [filter]
            id=Talar
        [/filter]
        [message]
            speaker=Talar
            message= _ "You can't be so stupid to try it! Muhaha!"
        [/message]

        {STORE_UNIT id=Talar position no}

#ifdef EASY
        {THUNDER (
            [kill]
                id=Talar
                animate=no
            [/kill]
            [unit]
                id=Talar2
                type=Ancient Lich2
                profile=portraits/mal-talar_lich.png
                x,y=$position.x,$position.y
                side=9
                overlays=misc/second-leader.png
                [modifications]
                    {TRAIT_HEALTHY}
                    {TRAIT_STRONG}
                [/modifications]
                goto_x=19
                goto_y=17
            [/unit]
        )}
#endif
#ifdef HARD
        {THUNDER (
            [kill]
                id=Talar
                animate=no
            [/kill]
            [unit]
                id=Talar2
                type=Lich King
                profile=portraits/mal-talar_lich.png
                x,y=$position.x,$position.y
                side=9
                overlays=misc/second-leader.png
                [modifications]
                    {TRAIT_HEALTHY}
                    {TRAIT_STRONG}
                [/modifications]
                goto_x=19
                goto_y=17
            [/unit]

        )}
#endif
        [message]
            speaker=Talar2
            message= _ "Yihahaha!"
        [/message]
        [message]
            speaker=Leogwyn
            message= _ "He trapped his soul! The fool! He is now much more vulnerable!"
        [/message]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Talar2
        [/filter]
        [message]
            speaker=Talar2
            message= _ "I...I can't...NOOO!"
        [/message]
		{CORPSE_EFFECT id=Talar2}
    [/event]


    ######################
    ##LANCE OF THE DEVIL##
    ######################

    [event]
        name=last breath
        [filter]
            id=Xanthos
        [/filter]
        [message]
            speaker=Xanthos
            message= _ "Ndat! Ndat sih fhew mjo erla rikswa yat weller! Agged sih tharla, sih fhew gih re-weller!"
        [/message]
        [message]
            speaker=second_unit
            message= _ "What does he say?"
        [/message]
        [role]
            type=Western Horseman,Western Cavalryman,Western Junior Commander,Western Commander,Western Knight,Western Lancer,Rider Of Apocalypse,General Of Death
            side=1
            role=Western_reporter
        [/role]
        [message]
            role=Western_reporter
            message= _ "He says 'No! You can't be so stupid that you kill your emperor. I'll give you everything, you can be my heir!'"
        [/message]
        [message]
            speaker=second_unit
            message= _ "Hmm...I think I will be more rewarded if I kill the Dark Emperor!"
        [/message]
        [message]
            speaker=Xanthos
            message= _ "Mmm...sih ndat rikswa ge!"
        [/message]


        {IFDEF_EASY (
            {EARTHQUAKE (
                [store_unit]
                    [filter]
                        id=Xanthos
                    [/filter]
    
                    kill=yes
                    variable=lance_place
                [/store_unit]
    
                # Side 7 is going to get the ships
                {MODIFY_UNIT id=Overlord side 7}
                {MODIFY_UNIT id=Ship1 side 7}
                {MODIFY_UNIT id=Ship2 side 7}
                {MODIFY_UNIT id=Ship3 side 7}
    
                # Kill the whole side 8
                [store_unit]
                    [filter]
                        side=8
                    [/filter]
    
                    kill=no
                    variable=corpse_to_be
                [/store_unit]
                {FOREACH corpse_to_be i}
                    {CORPSE_EFFECT (find_in=corpse_to_be[$i])}
                {NEXT i}
    
                {CLEAR_VARIABLE corpse_to_be}
    
                {VARIABLE lance_of_the_devil_dropped 1}
                [item]
                    x=$lance_place.x
                    y=$lance_place.y
                    image=items/lance_of_the_devil.png
                [/item]
            )}
        )}
        {IFDEF_HARD (
            {EARTHQUAKE (
                [store_unit]
                    [filter]
                        id=Xanthos
                        animate=no
                    [/filter]
    
                    kill=yes
                    variable=lance_place
                [/store_unit]
                {VARIABLE lance_of_the_devil_dropped 1}
                [item]
                    x=$lance_place.x
                    y=$lance_place.y
                    image=items/lance_of_the_devil.png
                [/item]
            )}
        )}


        [message]
            speaker=second_unit
            message= _ "Bloody hell! He fled away! But he dropped something...I think it's the lance!!!"
        [/message]

        # On hard level, side 7 will be trying to get the lance on high priority
#ifdef HARD
        [modify_side]
            side=7
            [target]
                x,y=$lance_place.x,$lance_place.y
                value=200
            [/target]
        [/modify_side]
#endif
    [/event]

    [event]
        name=moveto
        [filter]
            side=7
            x=$lance_place.x
            y=$lance_place.y
        [/filter]
        [if]
            [variable]
                name=lance_of_the_devil_dropped
                numerical_equals=1
            [/variable]
            [then]
                [message]
                    speaker=Aethyr
                    message= _ "Oh no! We won't be able to fight the Lance out again! We're lost!"
                [/message]
                {DEFEAT}
            [/then]
        [/if]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=$lance_place.x
            y=$lance_place.y
        [/filter]
        [if]
            [variable]
                name=lance_of_the_devil_dropped
                numerical_equals=1
            [/variable]
            [then]
                [music]
                    name=lance_of_the_devil.ogg
                    play_once=yes
                [/music]
                [object]
                   name= _ "Lance of the Devil"
                   image=attacks/lance.png
                   duration=forever
                   description= _ "A big, magic Lance, which was owned by the Devil if the story is true. The most powerful weapon in the whole game."
                [/object] 
                [message]
                    speaker=unit
                    message= _ "Yes! Yes, it's really the Lance!"
                [/message]
                [remove_item]
                    x,y=$lance_place.x,$lance_place.y
                    image=items/lance_of_the_devil.png
                [/remove_item]

                {STORE_UNIT id=Aethyr pozition no}
                {MOVE_UNIT x,y=$lance_place.x,$lance_place.y $pozition.x $pozition.y}

                {CLEAR_VARIABLE pozition}

                [message]
                    speaker=Aethyr
                    message= _ "Thank you! Finally! We have it!"
                [/message]
                [if]
                    [variable]
                        name=chosen
                        numerical_equals=1
                    [/variable]
                    [then]
                        [message]
                            speaker=Lawrence
                            message= _ "Good work lieutenant! Now...give it to me!"
                        [/message]
                        [message]
                            speaker=Aethyr
                            message= _ "Well...er..."
                        [/message]
                        [message]
                            speaker=Lawrence
                            message= _ "What the hell are you waiting for?!"
                        [/message]
                        [message]
                            speaker=Aethyr
                            [option]
                                message= _ "Here you are..."
                                [command]
                                    [object]
                                        silent=yes
                    					[filter]
                        					id=Lawrence
                    					[/filter]
                    					[effect]
                      					    apply_to=new_attack
                        					name=lance
                        					description= _ "Lance of the Devil"
                        					icon=attacks/lance.png
                        					type=pierce
                        					range=melee
                        					[specials]
                          					    {WEAPON_SPECIAL_CHARGE}
                            					{WEAPON_SPECIAL_MAGICAL}
                                                {WEAPON_SPECIAL_FIRSTSTRIKE}
                        					[/specials]
                        					damage=30
                        					number=5
                    					[/effect]
                    					[effect]
                         					apply_to=hitpoints
                         					increase_total=10
                    					[/effect]
                					[/object]

                                    {FULL_HEAL id=Lawrence}
                                    [if]
                                        [have_unit]
                                            side=5
                                            id=Haldric
                                        [/have_unit]
                                        [then]
                                            [message]
                                                speaker=Lawrence
                                                message= _ "You decided well, I won't forget this. Now, ruin these wesnothians last hope! Kill the king!"
                                            [/message]
                                            {VARIABLE Lawrence 1}
                                        [/then]
										[else]
                                            [message]
                                                speaker=Lawrence
                                                message= _ "You decided well, I won't forget this. Let's head for Weldyn, the capital city!"
                                            [/message]
                                            {VICTORY_NEXT (12b_Crossroads)}
                                        [/else]
									[/if]
                                [/command]
                            [/option]
                            [option]
                                message= _ "Men, take him as a prisoner! You'll never get my Lance!"
                                [command]
                                    [object]
                                        silent=yes
                    					[filter]
                        					id=Aethyr
                    					[/filter]
                    					[effect]
                      					    apply_to=new_attack
                        					name=lance
                        					description= _ "Lance of the Devil"
                        					icon=attacks/lance.png
                        					type=pierce
                        					range=melee
                        					[specials]
                          					    {WEAPON_SPECIAL_CHARGE}
                            					{WEAPON_SPECIAL_MAGICAL}
                                                {WEAPON_SPECIAL_FIRSTSTRIKE}
                        					[/specials]
                        					damage=30
                        					number=5
                    					[/effect]
                    					[effect]
                         					apply_to=hitpoints
                         					increase_total=10
                    					[/effect]
                					[/object]
                                    {FULL_HEAL id=Aethyr}

									[message]
                                        speaker=Aethyr
                                        message= _ "Yes! This really is the beauty herself! This lance...excellent work! I can feel as it's power is scattering in my arm!"
                                    [/message]
                                    [if]
                                        [have_unit]
                                            side=5
                                            id=Haldric
                                        [/have_unit]
                                        [then]
                                            [message]
                                       		    speaker=Leogwyn
                                        		message= _ "My Emperor, what should we do? Lawrence will never let himself to catch, and the wesnothian king is still here."
                                    		[/message]
                                            [message]
   												speaker=Aethyr
												[option]
												    message= _ "I'd like to try the Lance's power! Kill them!"
													[command]
														[message]
															speaker=Aethyr
															message= _ "Anyway, our recruits gotta get some experience."
														[/message]

                                                        [modify_side]
                                                            side=2
                                                            team_name=Lawrence
                                                        [/modify_side]
                                                        [modify_side]
                                                            side=3
                                                            team_name=Lawrence
                                                        [/modify_side]
														{REDRAW_SIDES 4}
   														{VARIABLE Aethyr 1}
													[/command]
												[/option]
												[option]
													message= _ "No, we sould leave now! It'd be too dangerous!"
													[command]
                                                        [modify_side]
                                                            side=2
                                                            team_name=Lawrence
                                                        [/modify_side]
                                                        [modify_side]
                                                            side=3
                                                            team_name=Lawrence
                                                        [/modify_side]
														{REDRAW_SIDES 4}
														[message]
															speaker=Leogwyn
															message= _ "Our destination My Emperor?"
														[/message]
														[message]
 															speaker=Aethyr
															message= _ "I don't wanna attack Wesnoth now, so let's head north."
														[/message]
														{VICTORY}
													[/command]
												[/option]
											[/message]
										[/then]
										[else]
											[message]
                                       		    speaker=Leogwyn
                                        		message= _ "My Emperor, what should we do? Lawrence will never let himself to catch."
                                    		[/message]
											[message]
   												speaker=Aethyr
												[option]
												    message= _ "I'd like to try the Lance's power! Kill him!"
													[command]
														[message]
															speaker=Aethyr
															message= _ "Anyway, our recruits gotta get some experience."
														[/message]
                                                        [modify_side]
                                                            side=2
                                                            team_name=Lawrence
                                                        [/modify_side]
                                                        [modify_side]
                                                            side=3
                                                            team_name=Lawrence
                                                        [/modify_side]
														{REDRAW_SIDES 4}

   														{VARIABLE Aethyr 2}
													[/command]
												[/option]
												[option]
													message= _ "No, we sould leave now! It'd be too dangerous!"
													[command]
														[message]
															speaker=Leogwyn
															message= _ "Our destination My Emperor?"
														[/message]
														[message]
 															speaker=Aethyr
															message= _ "Although the king fled, I don't wanna chase him now. Let's head north!"
														[/message]
														{VICTORY}
													[/command]
												[/option]
											[/message]
										[/else]
									[/if]
								[/command]
							[/option]
						[/message]
					[/then]
				[/if]


                # HALDRIC
				[if]
                    [variable]
						name=chosen
						numerical_equals=2
					[/variable]
					[then]
				        [message]
                            speaker=Haldric
                            message= _ "Good work knight! Now...give it to me!"
                        [/message]
                        [message]
                            speaker=Aethyr
                            message= _ "Well...er..."
                        [/message]
                        [message]
                            speaker=Haldric
                            message= _ "What are you waiting for?!"
                        [/message]
                        [message]
                            speaker=Aethyr
                            [option]
                                message= _ "Here you are..."
								## UNFINISHED BRANCH SOLVED BY AN IMPOSSIBLE SHOW_IF
								[show_if]
									[variable]
										name=beta_version
										equals=nope
									[/variable]
								[/show_if]
                                [command]
                                    {WARNING "You've chosen an unfisihed branch! It will lead to instant defeat, so undo this decision!"}

                                    [object]
                                        silent=yes
                    					[filter]
                        					id=Haldric
                    					[/filter]
                    					[effect]
                      					    apply_to=new_attack
                        					name=lance
                        					description= _ "Lance of the Devil"
                        					icon=attacks/lance.png
                        					type=pierce
                        					range=melee
                        					[specials]
                            					{WEAPON_SPECIAL_MAGICAL}
                                                {WEAPON_SPECIAL_FIRSTSTRIKE}
                        					[/specials]
                        					damage=30
                        					number=5
                    					[/effect]
                    					[effect]
                         					apply_to=hitpoints
                         					increase_total=10
                    					[/effect]
                					[/object]

                                    {FULL_HEAL id=Haldric}
                                    [if]
                                        [have_unit]
                                            side=2
                                            id=Lawrence
                                        [/have_unit]
                                        [then]
                                            [message]
                                                speaker=Haldric
                                                message= _ "You decided well, I will never forget this. But your company is still there, kill them too!"
                                            [/message]
                                            {VARIABLE Haldric 1}
                                        [/then]
										[else]
                                            [message]
                                                speaker=Haldric
                                                message= _ "You decided well, I will never forget this. Let's chase those western knights! But first...step forward Aethyr, Count of Dan' Tonk!"
                                            [/message]
                                            [message]
                                                speaker=Aethyr
                                                message= _ "Oh, thank you My King!"
                                            [/message]
                                            {VICTORY_NEXT (12c_Wind_Of_Sloughter)}
                                        [/else]
									[/if]
                                [/command]
                            [/option]
                            [option]
                                message= _ "Men, take him as a prisoner! You'll never get my Lance!"
                                [command]
                                    [object]
                                        silent=yes
                    					[filter]
                        					id=Aethyr
                    					[/filter]
                    					[effect]
                      					    apply_to=new_attack
                        					name=lance
                        					description= _ "Lance of the Devil"
                        					icon=attacks/lance.png
                        					type=pierce
                        					range=melee
                        					[specials]
                          					    {WEAPON_SPECIAL_CHARGE}
                            					{WEAPON_SPECIAL_MAGICAL}
                                                {WEAPON_SPECIAL_FIRSTSTRIKE}
                        					[/specials]
                        					damage=30
                        					number=5
                    					[/effect]
                    					[effect]
                         					apply_to=hitpoints
                         					increase_total=10
                    					[/effect]
                					[/object]
                                    {FULL_HEAL id=Aethyr}

									[message]
                                        speaker=Aethyr
                                        message= _ "Yes! This really is the beauty herself! This lance...excellent work! I can feel as it's power is scattering in my arm!"
                                    [/message]
                                    [if]
                                        [have_unit]
                                            side=2
                                            id=Lawrence
                                        [/have_unit]
                                        [then]
                                            [message]
                                       		    speaker=Leogwyn
                                        		message= _ "My Emperor, what should we do? King Haldric  will never let himself to catch, and Lawrence is still here too."
                                    		[/message]
                                            [message]
   												speaker=Aethyr
												[option]
												    message= _ "I'd like to try the Lance's power! Kill them!"
													[command]
														[message]
															speaker=Aethyr
															message= _ "Anyway, our recruits gotta get some experience."
														[/message]
                                                        [modify_side]
                                                            side=5
                                                            team_name=Haldric
                                                        [/modify_side]
                                                        [modify_side]
                                                            side=6
                                                            team_name=Haldric
                                                        [/modify_side]
														{REDRAW_SIDES 6}

   														{VARIABLE Aethyr 1}
													[/command]
												[/option]
												[option]
													message= _ "No, we sould leave now! It'd be too dangerous!"
													[command]
														[message]
															speaker=Leogwyn
															message= _ "Our destination My Emperor?"
														[/message]
														[message]
 															speaker=Aethyr
															message= _ "I don't wanna attack the Western Kingdom now, so let's head north."
														[/message]
														{VICTORY}
													[/command]
												[/option]
											[/message]
										[/then]
										[else]
											[message]
                                       		    speaker=Leogwyn
                                        		message= _ "My Emperor, what should we do? King Haldric will never let himself to catch."
                                    		[/message]
											[message]
   												speaker=Aethyr
												[option]
												    message= _ "I'd like to try the Lance's power! Kill him!"
													[command]
														[message]
															speaker=Aethyr
															message= _ "Anyway, our recruits gotta get some experience."
														[/message]
                                                        [modify_side]
                                                            side=5
                                                            team_name=Haldric
                                                        [/modify_side]
                                                        [modify_side]
                                                            side=6
                                                            team_name=Haldric
                                                        [/modify_side]
														{REDRAW_SIDES 6}

   														{VARIABLE Aethyr 3}
													[/command]
												[/option]
												[option]
													message= _ "No, we sould leave now! It'd be too dangerous!"
													[command]
														[message]
															speaker=Leogwyn
															message= _ "Our destination My Emperor?"
														[/message]
														[message]
 															speaker=Aethyr
															message= _ "Although Lawrence fled, I don't wanna chase him now. Let's head north!"
														[/message]
														{VICTORY}
													[/command]
												[/option]
											[/message]
										[/else]
									[/if]
								[/command]
							[/option]
						[/message]
					[/then]
				[/if]
			[/then]
		[/if]
	[/event]

    ##IF LAWRENCE DROPS##

    [event]
        name=moveto
        [filter]
            side=1
            x=$lance_new.x
            y=$lance_new.y
        [/filter]
        [if]
            [variable]
                name=lance_of_the_devil_dropped
                numerical_equals=2
            [/variable]
            [then]
                {VARIABLE lance_of_the_devil_dropped 3}
 
                [message]
                    speaker=unit 
                    message= _ "I have it!"
                [/message]
                [remove_item]
                    x,y=$lance_new.x,$lance_new.y
                    image=items/lance_of_the_devil.png
                [/remove_item]

                {STORE_UNIT id=Aethyr position no}
                {MOVE_UNIT x,y=$lance_new.x,$lance_new.y $position.x $position.y}
                {CLEAR_VARIABLE position}

                [object]
                    name= _ "Lance of the Devil"
                    image=attacks/lance.png
                    duration=forever
                    description= _ "A big, magic Lance, which was owned by the Devil if the story is true. The most powerful weapon in the whole game."
                    [filter]
                        id=Aethyr
                    [/filter]
                    [effect]
                      	apply_to=new_attack
                        name=lance
                        description= _ "Lance of the Devil"
                        icon=attacks/lance.png
                        type=pierce
                        range=melee
                        [specials]
                        	{WEAPON_SPECIAL_CHARGE}
                            {WEAPON_SPECIAL_MAGICAL}
                            {WEAPON_SPECIAL_FIRSTSTRIKE}
                        [/specials]
                        damage=30
                        number=5
                    [/effect]
                    [effect]
                    	apply_to=hitpoints
                        increase_total=10
                    [/effect]
                [/object] 
                
                [message]
                    speaker=Aethyr
                    message= _ "And still, we have the Lance! Now..."
                    [option]
                        message= _ "Hop it! Head north!"
                        [command]
                            {VICTORY}
                        [/command]
                    [/option]
                    [option]
                        message= _ "Let's attack that king or what!"
                        [command]
                            {VARIABLE Aethyr 3}
                            {VARIABLE Lawrence 0}
                        [/command]
                    [/option]
                [/message]

                {CLEAR_VARIABLE lance_new,position}
            [/then]
        [/if]
    [/event]

    # If anybody else gets the Lance, you are defeated
    #[event]
    #    name=moveto
    #    [filter]
    #        [not]
    #            side=1
    #        [/not]
    #        x=$lance_new.x
    #        y=$lance_new.y
    #    [/filter]
    #    [if]
    #        [variable]
    #            name=lance_of_the_devil_dropped
    #            numerical_equals=2
    #        [/variable]
    #        [then]
    #            {VARIABLE lance_of_the_devil_dropped 3}
    #            {CLEAR_VARIABLE lance_new,position}

    #            [message]
    #                speaker=unit
    #                message= _ "From now, none will get the Lance!"
    #            [/message]
    #            {DEFEAT}
    #        [/then]
    #    [/if]
    #[/event]



    

    ###################
    ##DEATHS, VICTORY##
    ###################

    ##LAWRENCE##
    [event]
        name=last breath
        [filter]
            id=Lawrence
        [/filter]
        [message]
            speaker=Lawrence
            message= _ "Augh!"
        [/message]
        [if]
            [variable]
                name=chosen
                numerical_equals=1
            [/variable]
            [and]
            [variable]
                name=Aethyr
                less_than=1
            [/variable]
            [/and]
            [and]
            [variable]
                name=Lawrence
                less_than=1
            [/variable]
            [/and]
            [then]
				[message]
                    speaker=Lawrence
                    message= _ "You stupid! Without me, Xanthos will come in Wesnoth, and the Dark Era continues!"
                [/message]
                {DEFEAT}
            [/then]
        [/if]


        [if]
            [variable]
                name=chosen
                numerical_equals=1
            [/variable]
            [and]
            [variable]
                name=Lawrence
                numerical_equals=1
            [/variable]
            [/and]
            [then]
				[message]
                    speaker=Lawrence
                    message= _ "No! Flee away, don't get killed!"
                [/message]
                {STORE_UNIT id=Lawrence lance_new yes}
                [item]
                    x,y=$lance_new.x,$lance_new.y
                    image=items/lance_of_the_devil.png
                [/item]
                {VARIABLE lance_of_the_devil_dropped 2}
                {VARIABLE Lawrence 2}
                {REDRAW}

                [message]
                    speaker=second_unit
                    message= _ "He dropped the Lance! We can get it now!"
                [/message]

                ## But, everybody is going to take it
                #define MODIFY_TARGETS_EFFECT SIDE
                        [modify_ai]
                            side={SIDE}
                            [target]
                                x,y=$lance_new.x,$lance_new.y
                                value=200
                            [/target]
                        [/modify_ai]
                #enddef
                {MODIFY_TARGETS_EFFECT 2}
                {MODIFY_TARGETS_EFFECT 3}
                {MODIFY_TARGETS_EFFECT 4}
                {MODIFY_TARGETS_EFFECT 5}
                {MODIFY_TARGETS_EFFECT 6}
                {MODIFY_TARGETS_EFFECT 7}
                {MODIFY_TARGETS_EFFECT 8}
                {MODIFY_TARGETS_EFFECT 9}
            [/then]
        [/if]

        [if]
            [variable]
                name=Aethyr
                numerical_equals=1
            [/variable]
            [or]
            [variable]
                name=Aethyr
                numerical_equals=2
            [/variable]
            [/or]
            [then]
				[message]
                    speaker=Lawrence
                    message= _ "No! A stupid traitor can't kill me!"
                [/message]
                {THUNDER (
                    [kill]
                        id=Lawrence
                        animate=no
                        fire_event=no
                    [/kill]
                )}

                [message]
                    speaker=Warwick
                    message= _ "He fled away! What next?"
                [/message]
                [if]
                    [variable]
                        name=Aethyr
                        numerical_equals=1
                    [/variable]
                    [then]
                		[message]
                    		speaker=Aethyr
                    		[option]
                        		message= _ "I can't have enough of this Lance! Try to kill Haldric II too!"
                        		[command]
                            		[message]
                                		speaker=Warwick
                                		message= _ "As you wish My Emperor!"
                            		[/message]
                            		{VARIABLE Aethyr 3}
                        		[/command]
                    		[/option]
                    		[option]
                        		message= _ "Don't ruin Wesnoth now. Let's head north!"
                        		[command]
                            		[message]
                                		speaker=Warwick
                                		message= _ "As you wish My Emperor!"
                            		[/message]
                            		{VICTORY}
                        		[/command]
                    		[/option]
                		[/message]
					[/then]
					[else]
						[message]
                    		speaker=Aethyr
                    		message= _ "Don't chase him now. Let's head north!"
                		[/message]
                        {VICTORY}
					[/else]
				[/if]
            [/then]
        [/if]





        [if]
            [variable]
                name=chosen
                numerical_equals=2
            [/variable]
            [and]
            [variable]
                name=Haldric
                numerical_equals=1
            [/variable]
            [/and]
            [then]
				[message]
                    speaker=Lawrence
                    message= _ "No! A stupid traitor can't kill me!"
                [/message]
                {THUNDER (
                    [kill]
                        id=Lawrence
                        animate=no
                        fire_event=no
                    [/kill]
                )}

                [message]
                    speaker=Haldric
                    message= _ "He fled away! What a coward!"
                [/message]
                [message]
                    speaker=Aethyr
                    message= _ "What now My King?"
                [/message]
                [message]
                    speaker=Haldric
                    message= _ "Of course we are going to chase him! But first...step forward Aethyr, Count of Dan' Tonk!"
                [/message]
                [message]
                    speaker=Aethyr
                    message= _ "Oh...thank you My King!"
                [/message]
                {VICTORY_NEXT (12c_Wind_Of_Sloughter)}
            [/then]
        [/if]

        [if]
            [variable]
                name=chosen
                numerical_equals=2
            [/variable]
            [and]
            [variable]
                name=Haldric
                numerical_not_equals=1
            [/variable]
            [/and]
            [and]
            [variable]
                name=Aethyr
                less_than=1
            [/variable]
            [/and]
            [then]
				[message]
                    speaker=Lawrence
                    message= _ "No! A stupid traitor can't kill me!"
                [/message]
                {THUNDER (
                    [kill]
                        id=Lawrence
                        animate=no
                        fire_event=no
                    [/kill]
                )}

                [message]
                    speaker=Haldric
                    message= _ "He fled away! What a coward! Aethyr! Hurry up with getting that Lance!"
                [/message]
                [message]
                    speaker=Aethyr
                    message= _ "A moment and I have it My King!"
                [/message]
            [/then]
        [/if]
    [/event]





    ## HALDRIC ##

    [event]
        name=last breath
        [filter]
            id=Haldric
        [/filter]

        [if]
            [variable]
                name=chosen
                numerical_equals=1
            [/variable]
            [and]
            [variable]
                name=Lawrence
                numerical_equals=1
            [/variable]
            [/and]
            [then]
                [role]
                    type=Bowman,Spearman,Longbowman
                    role=Reporter
                [/role]
                [message]
                    role=Reporter
                    message= _ "My Lord, this way!"
                [/message]
                [message]
                    speaker=Haldric
                    message= _ "I have to flee now, but we will meet again!"
                [/message]
                [message]
                    speaker=Lawrence
                    message= _ "I think so. After him!"
                [/message]
                {VICTORY_NEXT (12b_Crossroads)}
            [/then]
        [/if]


        [if]
            [variable]
                name=chosen
                numerical_equals=1
            [/variable]
            [and]
            [variable]
                name=Lawrence
                less_than=1
            [/variable]
            [/and]
            [and]
            [variable]
                name=Aethyr
                less_than=1
            [/variable]
            [/and]
            [then]
                [role]
                    type=Bowman,Spearman,Longbowman
                    role=Reporter
                [/role]
                [message]
                    role=Reporter
                    message= _ "My Lord, this way!"
                [/message]
                [message]
                    speaker=Haldric
                    message= _ "I have to flee now, but we will meet again!"
                [/message]
                [message]
                    speaker=Lawrence
                    message= _ "I think so. We're gonna chase you after we got the Lance! Aethyr, hurry up!"
                [/message]
            [/then]
        [/if]

        [if]
            [variable]
                name=Aethyr
                numerical_equals=1
            [/variable]
            [or]
            [variable]
                name=Aethyr
                numerical_equals=3
            [/variable]
            [/or]
            [then]
                [role]
                    type=Bowman,Spearman,Longbowman
                    role=Reporter
                [/role]
                [message]
                    role=Reporter
                    message= _ "My Lord, this way!"
                [/message]
                [if]
                    [variable]
                        name=chosen
                        numerical_equals=2
                    [/variable]
                    [then]
                        [message]
                    		speaker=Haldric
                    		message= _ "Aethyr, you betrayed me! I have to flee now, but once you will be hanged by the neck until death! I vow!"
                		[/message]
                    [/then]
				[/if]
				[if]
					[variable]
                        name=chosen
                        numerical_equals=1
                    [/variable]
                    [then]
                        [message]
                    		speaker=Haldric
                    		message= _ "I have to flee now, but I promise that once you will be hanged by the neck until death! Every western!"
                		[/message]
                    [/then]
				[/if]
                [message]
					speaker=Aethyr
					message= _ "Oh, we're all frightened."
				[/message]
				[kill]
					id=Haldric
					animate=no
				   	fire_event=no
				[/kill]
				[message]
                    speaker=Leogwyn
                    message= _ "What a cowardly pearson! So now?"
                [/message]
                [if]
                    [variable]
                        name=Aethyr
                        numerical_equals=1
                    [/variable]
                    [then]
                		[message]
                    		speaker=Aethyr
                    		[option]
                        		message= _ "I can't have enough of this Lance! Try to kill Lawrence too!"
                        		[command]
                            		[message]
                                		speaker=Warwick
                                		message= _ "As you wish My Emperor!"
                            		[/message]
                            		{VARIABLE Aethyr 2}
                        		[/command]
                    		[/option]
                    		[option]
                        		message= _ "Don't attack Lawrence now. Let's head north!"
                        		[command]
                            		[message]
                                		speaker=Warwick
                                		message= _ "As you wish My Emperor!"
                            		[/message]
                            		{VICTORY}
                        		[/command]
                    		[/option]
                		[/message]
					[/then]
					[else]
						[message]
                    		speaker=Aethyr
                    		message= _ "Don't chase him now. Let's head north!"
                		[/message]
                        {VICTORY}
					[/else]
				[/if]
            [/then]
        [/if]


        [if]
            [variable]
                name=chosen
                numerical_equals=2
            [/variable]
            [and]
            [variable]
                name=Aethyr
                less_than=1
            [/variable]
            [/and]
            [and]
            [variable]
                name=Haldric
                less_than=1
            [/variable]
            [/and]
            [then]
                [message]
                    speaker=Haldric
                    message= _ "Ugh...I shall die as the King of Wesnoth!"
                [/message]
                [message]
                    speaker=Aethyr
                    message= _ "Without any help, we can't get the Lance!"
                [/message]
                {DEFEAT}
            [/then]
        [/if]


        [if]
            [variable]
                name=chosen
                numerical_equals=2
            [/variable]
            [and]
            [variable]
                name=Haldric
                numerical_equals=1
            [/variable]
            [/and]
            [then]
                [message]
                    speaker=Haldric
                    message= _ "What a weak relic is this? It has let us down!"
                [/message]
                {DEFEAT}
            [/then]
        [/if]
    [/event]


    [event]
        name=last breath
        [filter]
            id=Aethyr
        [/filter]
        [message]
            speaker=Aethyr
            message= _ "Ugh...I'll never see again the commodore, Arya, or my beautiful home, the West! Don't get deprest! Carry on fighting despite being without me!"
        [/message]
        [message]
            speaker=narrator
            caption= _ "One of the captains"
            image=portraits/humans/transparent/lieutenant.png
            message= _ "Fight without a leader? Impossible. Then we're defeated."
        [/message]
        [endlevel]
            side=1
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Morgan
        [/filter]
        [if]
            [variable]
                name=Morgan_human
                numerical_equals=1
            [/variable]
            [then]
                [message]
                    speaker=Morgan
                    message= _ "Aughblblbl..."
                [/message]
                [message]
                    speaker=Aethyr
                    message= _ "Without any guide, we're lost!"
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Morgan
                    message= _ "So now I die permanently."
                [/message]
                [message]
                    speaker=Aethyr
                    message= _ "We can't suffer losing you again!"
                [/message]
            [/else]
        [/if]
        [endlevel]
            side=1
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Warwick
        [/filter]
        [message]
            speaker=Warwick
            message= _ "Ugh...I wonder did it worth to escape that damn prison..."
        [/message]
        [message]
            speaker=Aethyr
            message= _ "We can't be victorious without you!"
        [/message]
        [endlevel]
            side=1
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Leogwyn
        [/filter]
        [message]
            speaker=Leogwyn
            message= _ "Ah, it seems I sould've been stronger to win..."
        [/message]
        [endlevel]
            side=1
            result=defeat
        [/endlevel]
    [/event]


    [event]
        name=last breath
        [filter]
            id=Raven
        [/filter]
        [message]
            speaker=Raven
            message= _ "I did what I had to do! I had my revenge, now I'll rest in peace."
        [/message]
        [message]
            speaker=Aethyr
            message= _ "Your death is not futile! You helped us a lot, and we'll never forget you."
        [/message]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Garak
        [/filter]
        [message]
            speaker=Garak
            message= _ "I die for the Western Kingdom!"
        [/message]
        [message]
            speaker=Aethyr
            message= _ "No! We can't lose a general!"
        [/message]
        [endlevel]
            side=1
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=victory
        [disallow_recruit]
            type=Spearman,Bowman
        [/disallow_recruit]

        {CLEAR_VARIABLE lance_of_the_devil_dropped,chosen,Aethyr,Lawrence,Haldric,added_gold}
	[/event]
[/scenario]
